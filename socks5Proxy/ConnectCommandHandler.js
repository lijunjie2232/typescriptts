'use strict';var a7_0x3486c0=a7_0x5e2e;function a7_0x25c5(){var _0x366f53=['Connection\x20to\x20remote\x20server\x20established','setupDataRelay','throw','__esModule','ConnectCommandHandler','destroyed','destroy','then','debug','get','port','value','255695OTKwTR','info','next','__awaiter','144441HdAOOT','Remote\x20connection\x20error:\x20','338982Iletof','relayData','./CommandHandler','cleanup','logger','Relaying\x20data\x20to\x20remote\x20server...','done','end','error','data','getOwnPropertyDescriptor','Error\x20processing\x20CONNECT\x20command:\x20','create','defineProperty','sendReply','clientSocket','processCommand','__importStar','25854iNFTgJ','__createBinding','Relaying\x20data\x20back\x20to\x20client...','host','writable','hasOwnProperty','31605eMbABV','../utils','configurable','240eCEUOA','createConnection','destinationSocket','default','net','apply','prototype','write','171727OxVocB','46900neIRhU'];a7_0x25c5=function(){return _0x366f53;};return a7_0x25c5();}(function(_0x5103a6,_0x28f85b){var _0x2cc1f0=a7_0x5e2e,_0x188198=_0x5103a6();while(!![]){try{var _0xb56870=parseInt(_0x2cc1f0(0x1e7))/0x1+-parseInt(_0x2cc1f0(0x1c4))/0x2+-parseInt(_0x2cc1f0(0x1c2))/0x3+parseInt(_0x2cc1f0(0x1e8))/0x4+parseInt(_0x2cc1f0(0x1be))/0x5+parseInt(_0x2cc1f0(0x1d6))/0x6+-parseInt(_0x2cc1f0(0x1dc))/0x7*(-parseInt(_0x2cc1f0(0x1df))/0x8);if(_0xb56870===_0x28f85b)break;else _0x188198['push'](_0x188198['shift']());}catch(_0x410f16){_0x188198['push'](_0x188198['shift']());}}}(a7_0x25c5,0x26428));function a7_0x5e2e(_0x4433fd,_0x2af57f){var _0x25c5e5=a7_0x25c5();return a7_0x5e2e=function(_0x5e2eaa,_0xf2d385){_0x5e2eaa=_0x5e2eaa-0x1be;var _0x471db5=_0x25c5e5[_0x5e2eaa];return _0x471db5;},a7_0x5e2e(_0x4433fd,_0x2af57f);}var __createBinding=this&&this[a7_0x3486c0(0x1d7)]||(Object['create']?function(_0x40bfdb,_0x1133a0,_0x1c03de,_0x30ee94){var _0x3cfb7e=a7_0x3486c0;if(_0x30ee94===undefined)_0x30ee94=_0x1c03de;var _0x954863=Object[_0x3cfb7e(0x1ce)](_0x1133a0,_0x1c03de);(!_0x954863||(_0x3cfb7e(0x1f2)in _0x954863?!_0x1133a0[_0x3cfb7e(0x1ec)]:_0x954863[_0x3cfb7e(0x1da)]||_0x954863[_0x3cfb7e(0x1de)]))&&(_0x954863={'enumerable':!![],'get':function(){return _0x1133a0[_0x1c03de];}}),Object[_0x3cfb7e(0x1d1)](_0x40bfdb,_0x30ee94,_0x954863);}:function(_0x2fc49d,_0x2d3ae9,_0x389190,_0x5b48cc){if(_0x5b48cc===undefined)_0x5b48cc=_0x389190;_0x2fc49d[_0x5b48cc]=_0x2d3ae9[_0x389190];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a7_0x3486c0(0x1d0)]?function(_0x2d5aee,_0x5060a2){var _0x3a7071=a7_0x3486c0;Object[_0x3a7071(0x1d1)](_0x2d5aee,_0x3a7071(0x1e2),{'enumerable':!![],'value':_0x5060a2});}:function(_0x3c2976,_0x479bd1){var _0x4cbee7=a7_0x3486c0;_0x3c2976[_0x4cbee7(0x1e2)]=_0x479bd1;}),__importStar=this&&this[a7_0x3486c0(0x1d5)]||function(_0x320741){var _0x3a18ce=a7_0x3486c0;if(_0x320741&&_0x320741[_0x3a18ce(0x1ec)])return _0x320741;var _0x396ac7={};if(_0x320741!=null){for(var _0x411341 in _0x320741)if(_0x411341!=='default'&&Object[_0x3a18ce(0x1e5)][_0x3a18ce(0x1db)]['call'](_0x320741,_0x411341))__createBinding(_0x396ac7,_0x320741,_0x411341);}return __setModuleDefault(_0x396ac7,_0x320741),_0x396ac7;},__awaiter=this&&this[a7_0x3486c0(0x1c1)]||function(_0x58978d,_0x119a0c,_0xa8577a,_0x527c4a){function _0x316a5e(_0x51b11a){return _0x51b11a instanceof _0xa8577a?_0x51b11a:new _0xa8577a(function(_0x347663){_0x347663(_0x51b11a);});}return new(_0xa8577a||(_0xa8577a=Promise))(function(_0x5a159d,_0x3e73ca){var _0x563667=a7_0x5e2e;function _0x494b53(_0x3c6c5c){var _0x131159=a7_0x5e2e;try{_0x32f6e9(_0x527c4a[_0x131159(0x1c0)](_0x3c6c5c));}catch(_0x222200){_0x3e73ca(_0x222200);}}function _0x5e0d5e(_0xdd0079){var _0x26d744=a7_0x5e2e;try{_0x32f6e9(_0x527c4a[_0x26d744(0x1eb)](_0xdd0079));}catch(_0x37ff6a){_0x3e73ca(_0x37ff6a);}}function _0x32f6e9(_0x36b534){var _0x5203ce=a7_0x5e2e;_0x36b534[_0x5203ce(0x1ca)]?_0x5a159d(_0x36b534[_0x5203ce(0x1f4)]):_0x316a5e(_0x36b534[_0x5203ce(0x1f4)])[_0x5203ce(0x1f0)](_0x494b53,_0x5e0d5e);}_0x32f6e9((_0x527c4a=_0x527c4a[_0x563667(0x1e4)](_0x58978d,_0x119a0c||[]))[_0x563667(0x1c0)]());});};Object[a7_0x3486c0(0x1d1)](exports,a7_0x3486c0(0x1ec),{'value':!![]}),exports[a7_0x3486c0(0x1ed)]=void 0x0;const net=__importStar(require(a7_0x3486c0(0x1e3))),utils_1=require(a7_0x3486c0(0x1dd)),CommandHandler_1=require(a7_0x3486c0(0x1c6));class ConnectCommandHandler extends CommandHandler_1['CommandHandler']{constructor(_0x17a99c,_0x403fcb,_0x5ab3d8,_0x343e4a){var _0x53bd53=a7_0x3486c0;super(_0x17a99c,_0x403fcb,_0x5ab3d8,_0x343e4a),this[_0x53bd53(0x1e1)]=null,this[_0x53bd53(0x1d4)]();}[a7_0x3486c0(0x1d4)](){return __awaiter(this,void 0x0,void 0x0,function*(){var _0xbdbe21=a7_0x5e2e;this['logger']['debug']('Processing\x20CONNECT\x20command');const _0x590b5f=this[_0xbdbe21(0x1cd)][0x0],_0xb8533c=this['data'][0x1],_0x4d162a=this['data'][0x2];if(_0x590b5f!==0x5||_0xb8533c!==0x1||_0x4d162a!==0x0){this[_0xbdbe21(0x1c8)][_0xbdbe21(0x1cc)]('Invalid\x20CONNECT\x20command\x20or\x20version'),(0x0,utils_1['sendReply'])(this['clientSocket'],0x1),this[_0xbdbe21(0x1c7)]();return;}try{const _0x39e1dc=(0x0,utils_1['parseDestination'])(this[_0xbdbe21(0x1cd)]);this[_0xbdbe21(0x1c8)][_0xbdbe21(0x1bf)]('Attempting\x20to\x20connect\x20to\x20'+_0x39e1dc[_0xbdbe21(0x1d9)]+':'+_0x39e1dc[_0xbdbe21(0x1f3)]),this[_0xbdbe21(0x1e1)]=net[_0xbdbe21(0x1e0)]({'host':_0x39e1dc['host'],'port':_0x39e1dc[_0xbdbe21(0x1f3)]},()=>{var _0x10c0d2=_0xbdbe21;this['logger'][_0x10c0d2(0x1bf)](_0x10c0d2(0x1e9)),(0x0,utils_1[_0x10c0d2(0x1d2)])(this[_0x10c0d2(0x1d3)],0x0),this[_0x10c0d2(0x1ea)]();}),this[_0xbdbe21(0x1e1)]['on'](_0xbdbe21(0x1cc),_0x36164d=>{var _0x33e75e=_0xbdbe21;this[_0x33e75e(0x1c8)][_0x33e75e(0x1cc)](_0x33e75e(0x1c3),_0x36164d),(0x0,utils_1[_0x33e75e(0x1d2)])(this[_0x33e75e(0x1d3)],0x1),this[_0x33e75e(0x1c7)]();});}catch(_0x5d6112){this['logger'][_0xbdbe21(0x1cc)](_0xbdbe21(0x1cf),_0x5d6112),(0x0,utils_1[_0xbdbe21(0x1d2)])(this[_0xbdbe21(0x1d3)],0x1),this['cleanup']();}});}[a7_0x3486c0(0x1ea)](){var _0x2c2aa0=a7_0x3486c0;if(!this['destinationSocket'])return;this[_0x2c2aa0(0x1d3)]['on'](_0x2c2aa0(0x1cd),_0x532795=>{var _0x5c7fe0=_0x2c2aa0,_0x511fc5;this[_0x5c7fe0(0x1c8)][_0x5c7fe0(0x1f1)](_0x5c7fe0(0x1c9),_0x532795),(_0x511fc5=this[_0x5c7fe0(0x1e1)])===null||_0x511fc5===void 0x0?void 0x0:_0x511fc5[_0x5c7fe0(0x1e6)](_0x532795);}),this[_0x2c2aa0(0x1e1)]['on'](_0x2c2aa0(0x1cd),_0x156ca9=>{var _0x3f6800=_0x2c2aa0;this[_0x3f6800(0x1c8)][_0x3f6800(0x1f1)](_0x3f6800(0x1d8),_0x156ca9),this[_0x3f6800(0x1d3)][_0x3f6800(0x1e6)](_0x156ca9);}),this[_0x2c2aa0(0x1d3)]['on'](_0x2c2aa0(0x1cb),()=>this[_0x2c2aa0(0x1c7)]()),this[_0x2c2aa0(0x1d3)]['on'](_0x2c2aa0(0x1cc),_0x185693=>{var _0x2cc309=_0x2c2aa0;this[_0x2cc309(0x1c8)][_0x2cc309(0x1f1)]('Error\x20from\x20client\x20socket:',_0x185693),this['cleanup']();});}[a7_0x3486c0(0x1c5)](_0x10ea2b){}['cleanup'](){var _0x516279=a7_0x3486c0;this[_0x516279(0x1c8)][_0x516279(0x1bf)]('Cleaning\x20up\x20CONNECT\x20command\x20handler'),this[_0x516279(0x1e1)]&&!this[_0x516279(0x1e1)][_0x516279(0x1ee)]&&(this[_0x516279(0x1e1)][_0x516279(0x1ef)](),this['destinationSocket']=null),!this[_0x516279(0x1d3)][_0x516279(0x1ee)]&&this[_0x516279(0x1d3)][_0x516279(0x1ef)](),super['cleanup']();}}exports[a7_0x3486c0(0x1ed)]=ConnectCommandHandler;